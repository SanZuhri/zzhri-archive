---
title: 'How to Add a New Collection'
pubDate: 2024-10-30
---

import FlowDiagram from '@/components/examples/FlowDiagram.astro'

export const collectionSteps = [
    {
        number: 1,
        title: 'Edit Config',
        description: 'Add collection entry to src/collections.config.ts'
    },
    {
        number: 2,
        title: 'Create Folder',
        description: 'Create folder: src/content/[collection-name]/'
    },
    {
        number: 3,
        title: 'Sync Types',
        description: 'Run: pnpm astro sync'
    },
    {
        number: 4,
        title: 'Add Content',
        description: 'Create your first .md or .mdx file'
    },
    {
        number: 5,
        title: 'Test',
        description: 'Run: npm run dev and visit /collections/'
    }
]

This guide will walk you through the **simplified process** of adding a new collection to your Archive using the unified collection system.

## What is a Collection?

A collection is a group of related posts. For example, you might have collections for:
- **Thoughts** - Reflections & ideas
- **Media** - Books, music, movies, etc
- **Gallery** - Photos & visuals
- **Projects** - Work & creativity

## New Simplified System

Archive now uses a **single source of truth** for collections. Instead of editing 5+ files, you only need to edit **one config file** and create a folder!

## Collection Creation Flow

<FlowDiagram steps={collectionSteps} title="Collection Setup Workflow" />

## Step-by-Step Guide

### Step 1: Edit Collections Config

Open `src/collections.config.ts` and add your new collection:

```typescript
export const CONTENT_STRUCTURE = {
  posts: { /* ... */ },
  thoughts: { /* ... */ },
  media: { /* ... */ },
  gallery: { /* ... */ },
  projects: { /* ... */ },
  
  // Add your new collection here
  recipes: {
    type: 'collection' as const,
    title: 'Recipes',
    description: 'Cooking recipes & food',
    urlPattern: '/collections/recipes/{slug}',
    listPage: '/collections/recipes/',
    backLabel: 'recipes',
    showInCollectionsList: true
  },
  
  about: { /* ... */ }
}
```

**What happens automatically:**
- ✅ Collection appears on `/collections/` page
- ✅ Routing is set up at `/collections/recipes/`
- ✅ Back buttons work correctly
- ✅ TypeScript types are ready after sync

### Step 2: Create the Content Folder

Create a new folder with the same name:

```bash
mkdir src/content/recipes
mkdir src/content/recipes/_assets
```

Or on Windows:
```bash
md src\content\recipes
md src\content\recipes\_assets
```

**Folder Structure:**
```
src/content/recipes/
├── _assets/          # Store images here
│   └── .gitkeep
├── README.md         # Optional: Collection documentation
└── (your posts here)
```

### Step 3: Sync TypeScript Types

Run Astro sync to generate types:

```bash
pnpm astro sync
```

You'll see output like:
```
[content] Syncing content
[content] Synced content
[types] Generated 500ms
```

**Why sync is needed:**
- Generates TypeScript types for your new collection
- Updates `.astro/` folder with type definitions
- Ensures type-safety across the application

### Step 4: Add Your First Post

Create a markdown file in your collection:

**File:** `src/content/recipes/chocolate-cake.md`

```markdown
---
title: 'Best Chocolate Cake Recipe'
pubDate: 2024-11-01
---

![Chocolate Cake](./\_assets/chocolate-cake.jpg)

This is my favorite chocolate cake recipe!

## Ingredients

- 2 cups flour
- 1 cup sugar
- 1/2 cup cocoa powder
- ...

## Instructions

1. Preheat oven to 350°F
2. Mix dry ingredients...
3. Bake for 30 minutes

![Finished cake](./\_assets/cake-finished.jpg)
```

**Don't forget to add images:**
- `src/content/recipes/_assets/chocolate-cake.jpg`
- `src/content/recipes/_assets/cake-finished.jpg`

### Step 5: Restart Dev Server & Test

**If dev server is running, stop it (Ctrl+C) and restart:**

```bash
npm run dev
```

**Or combine sync + start in one command:**

```bash
pnpm astro sync && npm run dev
```

**Why restart is needed:**
- Astro needs to reload configuration
- New routes need to be generated
- Vite needs to re-optimize dependencies

Then visit:
- `http://localhost:4321/collections/` - See your collection listed
- `http://localhost:4321/collections/recipes/` - View collection page
- `http://localhost:4321/collections/recipes/chocolate-cake/` - View your post

## Configuration Properties Explained

Each collection in `CONTENT_STRUCTURE` has these properties:

| Property | Required | Description | Example |
|----------|----------|-------------|---------|
| `type` | ✅ | Collection type | `'collection'` |
| `title` | ✅ | Display name | `'Recipes'` |
| `description` | ✅ | Short description | `'Cooking recipes & food'` |
| `urlPattern` | ✅ | URL structure | `'/collections/recipes/{slug}'` |
| `listPage` | ✅ | Collection list URL | `'/collections/recipes/'` |
| `backLabel` | ✅ | Back button text | `'recipes'` |
| `showInCollectionsList` | ✅ | Show on /collections/ | `true` |

**Important Notes:**
- Use `type: 'collection' as const` for regular collections
- Use lowercase for collection names (no spaces)
- Keep descriptions short (under 50 characters)
- URL pattern must include `{slug}` placeholder

## Empty Collections

Collections can be empty (0 posts) and will still appear on the collections page with a count of 0. This is useful for:
- Planning future content
- Showing what's coming soon
- Maintaining consistent navigation

**Note:** You may see warnings like:
```
[WARN] [glob-loader] No files found matching "**/*.{md,mdx}" in directory "src\content\gallery"
```

This is **normal and not an error**. The collection will still work - just add your first post when ready!

## Removing a Collection

To remove a collection:

1. Delete the entry from `src/collections.config.ts`
2. Optionally delete the folder from `src/content/`
3. Run `pnpm astro sync`

## When to Sync & Restart

Understanding when you need to sync and restart saves time:

### ✅ NO Sync/Restart Needed (Hot Reload Works)

These changes are detected automatically:
- Adding new posts to existing collections
- Editing content in `.md` or `.mdx` files
- Updating frontmatter (title, date, etc.)
- Adding images to `_assets/` folders
- Modifying component files

Just save the file and refresh your browser!

### ❌ Sync + Restart Required

These changes need `pnpm astro sync` and dev server restart:
- Adding a new collection to `collections.config.ts`
- Modifying collection properties in `collections.config.ts`
- Editing `content.config.ts`
- Editing `astro.config.ts`
- Installing new npm packages

**Quick command:**
```bash
pnpm astro sync && npm run dev
```

## Tips

- Use descriptive collection names (lowercase, no spaces)
- Keep collection descriptions short and clear
- Organize posts logically within each collection
- Use consistent naming conventions for post files
- Remember to sync + restart after adding collections
